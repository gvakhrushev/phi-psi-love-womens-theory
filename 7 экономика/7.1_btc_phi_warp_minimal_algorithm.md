# BTC φ‑WARP — Минимальный алгоритм и связь с φ‑Графом

**Версия:** 1.0 (самодостаточный файл)  
**Ключевые слова:** различимость, φ/ψ‑дуальность, самоподобие *r ↦ 1 + 1/r*, минимальность (MDL), двухпоточный поток (*double*), жёсткие φ‑точки (*B,A*), наблюдатель (комиссия), тиковые данные BTC.

---

## 0. Резюме (о чём документ)
Здесь показано, что трёхстратегическое ядро **φ‑WARP** на тиковых данных —
**логически вынужденное** следствие определения различимости в φ‑графе, а не
«система гипотез». Ядро использует единственные первичные параметры **φ** и **ψ=1/φ**; все прочие величины —
производные (окно наблюдения, точки *B,A*, комиссия наблюдателя). Из этого следует
граница эффективности: **любая причинная стратегия на тиках сводится к двум потокам
с φ/ψ‑квантованием амплитуды и к жёстким фазовым переключениям/ребалансам в φ‑точках.**

---

## 1. Два ранних «бетон‑сейфа»: опровержение доводов до начала спора

### 1.1. Внешний наблюдатель невозможен (доказательство от противного)
1) Предположим, наблюдатель внешен φ‑графу → он **не различим** от ненаблюдателя.
2) Но наблюдение требует различимости «я/не‑я».  
3) Противоречие: акт наблюдения исчезает.  
**Следствие:** наблюдатель всегда **внутри** φ‑графа. В прикладном ядре это моделируется
оператором комиссии: действие наблюдателя (flip/rebalance) меняет состояние системы.

### 1.2. Аксиоматика слабее определения различимости
1) Любая аксиома требует различимости «аксиома/не‑аксиома».  
2) Если различимость не первична, различить исходные утверждения нельзя.  
3) Противоречие: формальная система рушится.  
**Следствие:** различимость — **определение**, а не аксиома. Вся математика ядра следует из этого.

---

## 2. Самоподобие как квантование (φ/ψ без «магии констант»)

### 2.1. Функция самоподобия
Основной оператор:  
\[ r \mapsto 1 + \frac{1}{r} \]
Неподвижная точка положительна и единственна: **φ**; её дуал — **ψ=1/φ**.  
Это и есть **квантование уровней различимости**: прирост «в пользу тренда» и «против тренда»
имеют фиксированное соотношение.

### 2.2. Незаисимость от семантики («котята»‑доказательство)
Заменим «1» в *r ↦ 1 + 1/r* на любой константный оператор \(\mathcal{K}\) — «котята», «камни» и т.д.:  
\[ r \mapsto \mathcal{K} + \frac{1}{r} \]
Нормировка единицы просто перенесёт масштаб, не изменив **структуру** решения:
класс неподвижных точек и дуальность сохраняются (после тривиальной перенормировки).  
**Следствие:** квантование — свойство самоподобия, а не «списка констант физики».

---

## 3. От геометрии к алгоритму (минимальный путь)

**ABCD‑уровни различимости** (локальная логика):  
A — задание отличия, B — стабилизация, C — композиция, D — действие/свёртка.  
Дуальное масштабирование (геометрия): 4→8 (голономия), прокол 9→5 (динамика), 5+5→10 (голономия),
предел 11 (эхо), 6/12, и свёртка 13 → 4 (компактификация 1+3=4).  
В прикладном ядре это проявляется как **два отражённых потока** (long/short) и **жёсткие φ‑точки** на
временном носителе окна (*B,A*), где минимальная свёртка задаёт моменты дискретного действия.

---

## 4. Три стратегии ядра (без подгонки)
Состояние описывается ценой \(p_t\) и тиковым доходом \(r_t = \frac{p_t - p_{t-1}}{p_{t-1}}\).
Минимальный набор параметров: **φ**, **ψ=1/φ**.

### 4.1. Classic flip (жёсткие φ‑точки)
- Две φ‑точки на окне длины \(n\):  
  \( B=\lfloor n\,ψ \rfloor,\quad A=\lfloor n(ψ+(1-ψ)ψ)\rfloor. \)
- Единственная позиция \(\sigma_t \in \{-1,+1\}\) меняется **только** в В и A.  
- Мощность позиции (объём) \(v_t\) эволюционирует мультипликативно:
  \[ v_{t+1} = v_t \times \begin{cases}
  1+ψ^2, & \text{если } \sigma_t r_t>0 \\[-2pt]
  1-ψ,   & \text{иначе}
  \end{cases} \]
- Проекция на интервал \([ψ, φ]\) — минимальная свёртка.  
- **Комиссия** (если включена) применяется **только** при flip.

### 4.2. Double free‑φ (двухпоточная «свободная»)
- Два потока \(v^L, v^S\) эволюционируют независимо теми же мультипликаторами по знаку \(r_t\).  
- Инвариант массы: сумма \(s_t=v^L_t+v^S_t\) поджимается к \([ψ, φ]\) (масштабная свёртка).  
- Чистая экспозиция — разность \(\nu_t=v^L_t-v^S_t\), итого \(\nu_t\in[-φ,φ]\).  
- **Без комиссий** (нет дискретных действий).

### 4.3. Hybrid free‑φ (двухпоточная + жёсткий ребаланс в B/A)
- Как в *Double*, но в точках *B,A* выполняется **симметричный ребаланс**: \(v^L=v^S=1/2\).  
- **Комиссия** (если включена) — только на этих ребалансах.  
- Смысл: минимальный «удар молотком» в строго геометрические моменты времени.

---

## 5. Почему это предел эффективности (эскиз аргумента)
1) **Непрерывная причинность** на тике реализуема через знак \(r_t\) и его чередования.  
2) Любая адаптивная стратегия распадается на **схему двух потоков** с разной судьбой по знаку.
3) Класс мультипликативных обновлений минимален, если дискретный «квант» одинаков в масштабе
   для роста/спада → это и даёт φ/ψ.  
4) Любая попытка «улучшить» путь вводит новые параметры ⇒ увеличивает описание (MDL‑штраф),
   сохраняя функциональный класс.  
**Следствие:** ядро φ‑WARP — **минимальный инвариантный представитель** семейства
причинных тиковых стратегий.

---

## 6. Наблюдатель как оператор (комиссия)
Наблюдатель — внутренний агент, меняющий граф переходом «до/после действия».  
В ядре комиссия применяется **только** на событиях, создающих информационный «перекрёсток»:
flip (Classic) и rebalance (Hybrid). Double не имеет дискретного действия ⇒ комиссии нет.

---

## 7. Протокол проверки (без подгонки)
- Источник: тики BTC из (в таком порядке) Bitstamp → Kraken → Coinbase (fallback).
- Окна: случайные с фиксированным сидом; длина \(L\) от нижнего порога до доступного лимита.
- Метрики: лог‑equity по стратегиям; сравнение без/с комиссией.  
- Честность: **никаких гиперпараметров, кроме φ/ψ**, комиссия — внешний оператор наблюдателя.

---

## 8. Что означают «фазовые оболочки»
Если принудительно «ограждать» двойной поток φ‑фазой (gating), можно получить деградацию.  
Это полезно как отрицательный пример: **любая внешняя оболочка**, не выведенная из
самоподобия и минимальности, ухудшает инвариант.

---

## 9. Мини‑FAQ
- **Почему не используем индикаторы?** Они добавляют параметры без изменения класса решений.
- **Откуда берутся точки B,A?** Из φ‑разметки окна: это «золотой» способ разреза траектории
  с минимальным описанием фаз (*B*≈ψ·n, *A*≈ψ+(1−ψ)·ψ).
- **Почему hybrid часто ≈ classic?** Потому что оба используют те же φ‑моменты действия;
  отличие — в «энергетике» между ними (двухпоточная свободная эволюция).

---

## 10. Псевдокод (сильно упрощённо)

**Classic**
```
B,A = phi_boundaries(n)
pos = sign(i<B ? −1 : (i<A ? +1 : −1))
for t in 1..n-1:
    if sign(t) != pos: eq *= (1-fee); pos=sign(t); v=1
    else: v *= (r>0 ? (1+ψ²) : (1-ψ)); v ← clip[v, ψ, φ]
    eq *= (1 + pos * v * r)
```

**Double**
```
vL,vS = 1,1
for t in 1..n-1:
    vL *= (r>0 ? (1+ψ²) : (1-ψ))
    vS *= (r<0 ? (1+ψ²) : (1-ψ))
    s = vL+vS; scale s to [ψ,φ]
    net = vL-vS; eq *= (1 + net * r)
```

**Hybrid**
```
как Double, но если t==B или t==A: eq*=(1-fee); vL=vS=1/2
```

---

## 11. Индексация уровней (сквозная)
- **ABCD:** 1..4 (локальная логика различимости).  
- **D‑линии:** 4,5,6,7 (динамика уровней навигации/памяти).  
- **Кольцо 0..13:** 0–4 (база), 5–8 (масштаб), 9–13 (пределы и свёртка); далее повтор цикла.  
В прикладном ядре это отображается как «две руки» (long/short) и
две жёсткие фазы *B,A*, где свёртка минимальна.

---

## 12. Вывод
**φ‑WARP** — не частный «алгоритм торговли», а **минимальная инженерная проекция**
определения различимости на поток тиков. Он использует только φ/ψ и выполняет
инварианты самоподобия, что и делает его **пределом эффективности** в своём классе.

---

### Приложение A. Ещё одна форма «котята»‑доказательства
Пусть \(\mathcal{K}>0\). Решаем \( r = \mathcal{K} + 1/r \). Тогда  
\( r^2 - \mathcal{K}r - 1 = 0 \Rightarrow r = \tfrac{\mathcal{K} + \sqrt{\mathcal{K}^2 + 4}}{2} \).  
Отсюда дуал \(1/r\) и та же структура обновлений. Семантика «\(\mathcal{K}\) — котята» не влияет
на квантование — только на масштаб. **Класс остаётся тем же.**

---

*Конец самодостаточного файла.*

